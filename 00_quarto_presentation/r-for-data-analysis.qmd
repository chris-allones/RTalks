---
title: "R programming for Data Analysis & Visualization"
author: "Christopher Llones"
format: 
  revealjs:
    theme: [simple, custom.scss]
    code-fold: true
    chalkboard: true
    slide-number: h/v
    footer: "R programming for Data Analysis & Visualization"
from: markdown+emoji
editor: visual
---

```{r include=FALSE}
library(tidyverse)

# Theme
theme_set(theme_minimal())
theme_update(plot.margin = margin(rep(20, 4)))
```


## Outline

::: {.incremental}

- Why R?
- Data visualization
- Data analysis

::: 

# Why R? :smirk:


## The Pros and Cons {.smaller}

:::: {.columns}

::: {.column width="60%"}
**Pros**

- free and open sources
- excellent for statistical computing and analysis
- powerful graphics
- cross-platform support
- large active and growing community users
- new statistical method often available first in R
:::

::: {.column width="40%"}
**Cons**

- learning curve could be steep
- may consumer large amount of memory
:::

::::


## Who are the R users? {.smaller}

```{r}
#| echo: false
#| fig-align: center
#| fig-width: 7

data_users <- tibble(
  industry = c("Academic", "Healthcare", "Government", "Consulting", "Insurance", "Energy", "Finance", "Retail", "Media", "Manufacturing", "Tech", "Electronics"),
  pct = c(7.8, 6.3, 3.7, 3.5, 2.5, 1.9, 1.8, 1.6, 1.5, 1.1, 0.8, 0.5)
)
data_users %>% 
  mutate(industry = fct_reorder(industry, pct)) %>% 
ggplot(aes(pct, industry)) +
  geom_col(fill = "#1d3557", width = 0.7) +
  scale_x_continuous(labels = scales::number_format(suffix = "%")) +
  theme(axis.text = element_text(size = 14),
        axis.title = element_blank())
```


## Who are the R users? {.smaller}

```{r}
#| echo: false
#| fig-align: center
#| fig-width: 7

data_lang <- tibble(
  lang = c("Python", "R", "SQL", "Scala", "SAS", "JAVA", "Matlab", "Hive", "C/C++", "Pig"),
  pct = c(90.4, 73.4, 58.5, 21.3, 18.1, 16.0, 14.9, 13.8, 7.4, 7.4)
)

data_lang %>% 
  mutate(lang = fct_reorder(lang, pct)) %>% 
ggplot(aes(pct, lang)) +
  geom_col(fill = "#1d3557", width = 0.7) +
  scale_x_continuous(labels = scales::number_format(suffix = "%")) +
  theme(axis.text = element_text(size = 14),
        axis.title = element_blank()) +
  labs(title = "Top 10 data science programming language by percent of jod ads")
```


# Data vizualisation in R

## 

[**Examples of vizualizations made with R**]{.blue}

```{r}
knitr::include_graphics("img/data_viz_collage.png")
```

## Bar plot {.smaller}

:::: {.columns}
::: {.column width="40%"}

```{r }
#| eval: false
#| echo: true
#| output-location: column-fragment
#| code-fold: show
#| code-line-numbers: "1-9|11-36"

# Data
int_penetration <- 
  tibble(country = rep(c("Latin America", "Global average", "Southeast Asia", "South Asia", "Sub-Saharan Africa"), 2),
       year = c(rep(2018, 5), rep(2014, 5)),
       pct = c(78, 70, 68, 61, 53, 64, 55, 44, 41, 35)
      ) %>% 
  mutate(year = factor(year) %>% fct_rev()) %>% 
  mutate(country = fct_reorder(country, pct) %>% fct_rev()) %>% 
  mutate(labs = str_glue("{pct}%"))

# Bar plot code
int_penetration %>% 
  ggplot(aes(country, pct)) +
  geom_col(aes(fill = year), position = position_dodge(width = 0.75), width = 0.7) +
  geom_text(aes(label = labs), position = position_dodge2(width = 0.75), 
            vjust = 1.3, hjust = 0.5, size = 7, color = "white") +
  scale_fill_manual(values = c("red", "black")) +
  guides(fill = guide_legend(nrow = 1,
                             label.position = "top",
                             keywidth = unit(25, "mm"),
                             keyheight = unit(1, "mm")
                             )) +
  theme(plot.background = element_rect(fill = "white", color = "white"),
        plot.title = element_text(size = 24, face = "bold", margin = margin(b = 30)),
        plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0, size = 12, face = "bold", color = "gray40", margin = margin(t=15)),
        axis.title.x = element_blank(),
        axis.text.x = element_text(size = 14),
        axis.text.y = element_blank(),
        axis.title.y = element_text(size = 16, color = "gray20"),
        legend.position = "bottom",
        legend.text = element_text(size = 14, face = "bold", margin = margin(b = 5))) +
  labs(title = "Growing mobile internet penetration allows more users to access\nagri e-commerce services",
       y = "% of unique subscribers, mobile internet",
       caption = "Source: GSMA\nAdopted from: Joiner & Okeleke (2019) E-commerce in agriculture: new business models\nfor smallholder's inclusion into formal economy.",
       fill = element_blank())

```
:::

::: {.column width="60%" }
<center>![](img/mobile_penetration.jpeg) </center>
:::
::::

















